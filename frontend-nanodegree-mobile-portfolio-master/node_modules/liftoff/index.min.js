var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
var fs=require("fs"),util=require("util"),path=require("path"),EE=require("events").EventEmitter,extend=require("extend"),resolve=require("resolve"),flaggedRespawn=require("flagged-respawn"),isPlainObject=require("lodash.isplainobject"),mapValues=require("lodash.mapvalues"),fined=require("fined"),findCwd=require("./lib/find_cwd"),findConfig=require("./lib/find_config"),fileSearch=require("./lib/file_search"),parseOptions=require("./lib/parse_options"),silentRequire=require("./lib/silent_require"),
buildConfigName=require("./lib/build_config_name"),registerLoader=require("./lib/register_loader");function Liftoff(a){EE.call(this);extend(this,parseOptions(a))}util.inherits(Liftoff,EE);Liftoff.prototype.requireLocal=function(a,c){try{var b=require(resolve.sync(a,{basedir:c}));this.emit("require",a,b);return b}catch(d){this.emit("requireFail",a,d)}};
Liftoff.prototype.buildEnvironment=function(a){a=a||{};var c=a.require||[];Array.isArray(c)||(c=[c]);var b=this.searchPaths.slice(),d=findCwd(a);a.cwd?b=[d]:b.unshift(d);var e=buildConfigName({configName:this.configName,extensions:Object.keys(this.extensions)}),b=findConfig({configNameSearch:e,searchPaths:b,configPath:a.configPath});if(b){var g=path.dirname(b);a.cwd||(d=g);fs.lstatSync(b).isSymbolicLink()&&(b=fs.realpathSync(b))}try{var f="win32"===process.platform?";":":",n=process.env.NODE_PATH?
process.env.NODE_PATH.split(f):[];var k=resolve.sync(this.moduleName,{basedir:g||d,paths:n});var h=silentRequire(fileSearch("package.json",[k]))}catch(q){}!k&&b&&(f=fileSearch("package.json",[g]),(h=silentRequire(f))&&h.name===this.moduleName?(k=path.join(path.dirname(f),h.main||"index.js"),d=g):h={});c.length&&c.filter(function(a,b,c){return c.indexOf(a)===b}).forEach(function(b){this.requireLocal(b,findCwd(a))},this);var l=this.extensions,m=this;registerLoader(m,l,b,d);f={};if(isPlainObject(this.configFiles))var p=
{path:null},f=mapValues(this.configFiles,function(a,b){var c={name:b,cwd:d,extensions:l};return mapValues(a,function(a){a=fined(a,c)||p;isPlainObject(a.extension)&&registerLoader(m,a.extension,a.path,d);return a.path})});return{cwd:d,require:c,configNameSearch:e,configPath:b,configBase:g,modulePath:k,modulePackage:h||{},configFiles:f}};Liftoff.prototype.handleFlags=function(a){"function"===typeof this.v8flags?this.v8flags(function(c,b){c?a(c):a(null,b)}):process.nextTick(function(){a(null,this.v8flags)}.bind(this))};
Liftoff.prototype.launch=function(a,c){if("function"!==typeof c)throw Error("You must provide a callback function.");process.title=this.processTitle;var b=a.completion;if(b&&this.completions)return this.completions(b);this.handleFlags(function(b,e){if(b)throw b;e?flaggedRespawn(e,process.argv,function(b,d){d!==process&&this.emit("respawn",process.argv.filter(function(a){a=a.split("=")[0];return-1!==e.indexOf(a)}.bind(this)),d);b&&c.call(this,this.buildEnvironment(a))}.bind(this)):c.call(this,this.buildEnvironment(a))}.bind(this))};
module.exports=Liftoff;
