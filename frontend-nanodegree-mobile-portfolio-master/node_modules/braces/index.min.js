/*
 braces <https://github.com/jonschlinkert/braces>

 Copyright (c) 2014-2015, Jon Schlinkert.
 Licensed under the MIT license.
*/
var expand=require("expand-range"),repeat=require("repeat-element"),tokens=require("preserve");module.exports=function(a,b){if("string"!==typeof a)throw Error("braces expects a string");return braces(a,b)};
function braces(a,b,c){if(""===a)return[];Array.isArray(b)||(c=b,b=[]);c=c||{};b=b||[];"undefined"===typeof c.nodupes&&(c.nodupes=!0);var d=c.fn;"function"===typeof c&&(d=c,c={});patternRe instanceof RegExp||(patternRe=patternRegex());switch((a.match(patternRe)||[])[0]){case "\\,":return escapeCommas(a,b,c);case "\\.":return escapeDots(a,b,c);case "/.":return escapePaths(a,b,c);case " ":return splitWhitespace(a);case "{,}":return exponential(a,c,braces);case "{}":return emptyBraces(a,b,c);case "\\{":case "\\}":return escapeBraces(a,
b,c);case "${":if(/\{[^{]+\{/.test(a)){var f=!0;a=tokens.before(a,es6Regex())}else return b.concat(a)}braceRe instanceof RegExp||(braceRe=braceRegex());var e=braceRe.exec(a);if(null==e)return[a];var h=e[1],e=e[2];if(""===e)return[a];if(-1!==e.indexOf(".."))d=expand(e,c,d)||e.split(","),e=d.length;else{if('"'===e[0]||"'"===e[0])return b.concat(a.split(/['"]/).join(""));d=e.split(",");if(c.makeRe)return braces(a.replace(h,wrap(d,"|")),c);e=d.length;1===e&&c.bash&&(d[0]=wrap(d[0],"\\"))}for(var k=d.length,
l=0,g;k--;){g=d[l++];if(/(\.[^.\/])/.test(g))return 1<e?d:[a];g=splice(a,h,g);/\{[^{}]+?\}/.test(g)?b=braces(g,b,c):""===g||c.nodupes&&-1!==b.indexOf(g)||b.push(f?tokens.after(g):g)}return c.strict?filter(b,filterEmpty):b}
function exponential(a,b,c){"function"===typeof b&&(c=b,b=null);b=b||{};var d=a.split("{,}");if(b.nodupes)return c(d.join(""),b);a=d.length-1;c=c(d.join("__ESC_EXP__"),b);for(var d=c.length,f=[],e=0;d--;){var h=c[e++];-1===h.indexOf("__ESC_EXP__")?f.push(h):(h=h.split("__ESC_EXP__").join(""))&&!1!==b.nodupes?f.push(h):f.push.apply(f,repeat(h,Math.pow(2,a)))}return f}
function wrap(a,b){if("|"===b)return"("+a.join(b)+")";if(","===b)return"{"+a.join(b)+"}";if("-"===b)return"["+a.join(b)+"]";if("\\"===b)return"\\{"+a+"\\}"}function emptyBraces(a,b,c){return braces(a.split("{}").join("\\{\\}"),b,c)}function filterEmpty(a){return!!a&&"\\"!==a}function splitWhitespace(a){a=a.split(" ");for(var b=a.length,c=[],d=0;b--;)c.push.apply(c,braces(a[d++]));return c}
function escapeBraces(a,b,c){return/\{[^{]+\{/.test(a)?(a=a.split("\\{").join("__LT_BRACE__"),a=a.split("\\}").join("__RT_BRACE__"),map(braces(a,b,c),function(a){a=a.split("__LT_BRACE__").join("{");return a.split("__RT_BRACE__").join("}")})):b.concat(a.split("\\").join(""))}function escapeDots(a,b,c){return/[^\\]\..+\\\./.test(a)?(a=a.split("\\.").join("__ESC_DOT__"),map(braces(a,b,c),function(a){return a.split("__ESC_DOT__").join(".")})):b.concat(a.split("\\").join(""))}
function escapePaths(a,b,c){a=a.split("/.").join("__ESC_PATH__");return map(braces(a,b,c),function(a){return a.split("__ESC_PATH__").join("/.")})}function escapeCommas(a,b,c){return/\w,/.test(a)?(a=a.split("\\,").join("__ESC_COMMA__"),map(braces(a,b,c),function(a){return a.split("__ESC_COMMA__").join(",")})):b.concat(a.split("\\").join(""))}function patternRegex(){return/\${|( (?=[{,}])|(?=[{,}]) )|{}|{,}|\\,(?=.*[{}])|\/\.(?=.*[{}])|\\\.(?={)|\\{|\\}/}
function braceRegex(){return/.*(\\?\{([^}]+)\})/}function es6Regex(){return/\$\{([^}]+)\}/}var braceRe,patternRe;function splice(a,b,c){var d=a.indexOf(b);return a.substr(0,d)+c+a.substr(d+b.length)}function map(a,b){if(null==a)return[];for(var c=a.length,d=Array(c),f=-1;++f<c;)d[f]=b(a[f],f,a);return d}
function filter(a,b){if(null==a)return[];if("function"!==typeof b)throw new TypeError("braces: filter expects a callback function.");for(var c=a.length,d=a.slice(),f=0;c--;)b(a[c],f++)||d.splice(c,1);return d};
