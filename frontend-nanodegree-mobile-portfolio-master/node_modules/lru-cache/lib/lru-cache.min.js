(function(){function m(){return 1}function g(a){n||"string"===typeof a||"number"===typeof a||(n=!0,console.error((new TypeError("LRU: key must be a string or number. Almost certainly a bug! "+typeof a)).stack))}function c(a){if(!(this instanceof c))return new c(a);"number"===typeof a&&(a={max:a});a||(a={});this._max=a.max;if(!this._max||"number"!==typeof this._max||0>=this._max)this._max=Infinity;this._lengthCalculator=a.length||m;"function"!==typeof this._lengthCalculator&&(this._lengthCalculator=
m);this._allowStale=a.stale||!1;this._maxAge=a.maxAge||null;this._dispose=a.dispose;this.reset()}function p(a,b,d){g(b);if(b=a._cache[b])k(a,b)?(h(a,b),a._allowStale||(b=void 0)):d&&(d=b,q(a,d),d.lu=a._mru++,a._lruList[d.lu]=d),b&&(b=b.value);return b}function k(a,b){if(!b||!b.maxAge&&!a._maxAge)return!1;var d=Date.now()-b.now;return b.maxAge?d>b.maxAge:a._maxAge&&d>a._maxAge}function l(a){for(;a._lru<a._mru&&a._length>a._max;)h(a,a._lruList[a._lru])}function q(a,b){for(delete a._lruList[b.lu];a._lru<
a._mru&&!a._lruList[a._lru];)a._lru++}function h(a,b){b&&(a._dispose&&a._dispose(b.key,b.value),a._length-=b.length,a._itemCount--,delete a._cache[b.key],q(a,b))}function r(a,b,d,t,c,f){this.key=a;this.value=b;this.lu=d;this.length=t;this.now=c;f&&(this.maxAge=f)}"object"===typeof module&&module.exports?module.exports=c:this.LRUCache=c;var n=!1;Object.defineProperty(c.prototype,"max",{set:function(a){if(!a||"number"!==typeof a||0>=a)a=Infinity;this._max=a;this._length>this._max&&l(this)},get:function(){return this._max},
enumerable:!0});Object.defineProperty(c.prototype,"lengthCalculator",{set:function(a){if("function"!==typeof a){this._lengthCalculator=m;this._length=this._itemCount;for(var b in this._cache)this._cache[b].length=1}else for(b in this._lengthCalculator=a,this._length=0,this._cache)this._cache[b].length=this._lengthCalculator(this._cache[b].value),this._length+=this._cache[b].length;this._length>this._max&&l(this)},get:function(){return this._lengthCalculator},enumerable:!0});Object.defineProperty(c.prototype,
"length",{get:function(){return this._length},enumerable:!0});Object.defineProperty(c.prototype,"itemCount",{get:function(){return this._itemCount},enumerable:!0});c.prototype.forEach=function(a,b){b=b||this;for(var d=0,c=this._itemCount,e=this._mru-1;0<=e&&d<c;e--)if(this._lruList[e]){d++;var f=this._lruList[e];k(this,f)&&(h(this,f),this._allowStale||(f=void 0));f&&a.call(b,f.value,f.key,this)}};c.prototype.keys=function(){for(var a=Array(this._itemCount),b=0,d=this._mru-1;0<=d&&b<this._itemCount;d--)if(this._lruList[d]){var c=
this._lruList[d];a[b++]=c.key}return a};c.prototype.values=function(){for(var a=Array(this._itemCount),b=0,d=this._mru-1;0<=d&&b<this._itemCount;d--)if(this._lruList[d]){var c=this._lruList[d];a[b++]=c.value}return a};c.prototype.reset=function(){if(this._dispose&&this._cache)for(var a in this._cache)this._dispose(a,this._cache[a].value);this._cache=Object.create(null);this._lruList=Object.create(null);this._itemCount=this._length=this._lru=this._mru=0};c.prototype.dump=function(){for(var a=[],b=
0,d=this._mru-1;0<=d&&b<this._itemCount;d--)if(this._lruList[d]){var c=this._lruList[d];k(this,c)||(++b,a.push({k:c.key,v:c.value,e:c.now+(c.maxAge||0)}))}return a};c.prototype.dumpLru=function(){return this._lruList};c.prototype.set=function(a,b,d){d=d||this._maxAge;g(a);var c=d?Date.now():0,e=this._lengthCalculator(b);if(Object.prototype.hasOwnProperty.call(this._cache,a)){if(e>this._max)return h(this,this._cache[a]),!1;this._dispose&&this._dispose(a,this._cache[a].value);this._cache[a].now=c;this._cache[a].maxAge=
d;this._cache[a].value=b;this._length+=e-this._cache[a].length;this._cache[a].length=e;this.get(a);this._length>this._max&&l(this);return!0}d=new r(a,b,this._mru++,e,c,d);if(d.length>this._max)return this._dispose&&this._dispose(a,b),!1;this._length+=d.length;this._lruList[d.lu]=this._cache[a]=d;this._itemCount++;this._length>this._max&&l(this);return!0};c.prototype.has=function(a){g(a);return!Object.prototype.hasOwnProperty.call(this._cache,a)||k(this,this._cache[a])?!1:!0};c.prototype.get=function(a){g(a);
return p(this,a,!0)};c.prototype.peek=function(a){g(a);return p(this,a,!1)};c.prototype.pop=function(){var a=this._lruList[this._lru];h(this,a);return a||null};c.prototype.del=function(a){g(a);h(this,this._cache[a])};c.prototype.load=function(a){this.reset();for(var b=Date.now(),d=a.length-1;0<=d;d--){var c=a[d];g(c.k);var e=c.e||0;0===e?this.set(c.k,c.v):(e-=b,0<e&&this.set(c.k,c.v,e))}}})();
