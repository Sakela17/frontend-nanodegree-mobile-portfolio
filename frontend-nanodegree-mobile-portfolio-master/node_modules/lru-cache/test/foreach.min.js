var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,b){return b})}},"es6","es3");var test=require("tap").test,LRU=require("../");
test("forEach",function(a){for(var c=new LRU(5),b=0;10>b;b++)c.set(b.toString(),b.toString(2));b=9;c.forEach(function(d,f,g){a.equal(g,c);a.equal(f,b.toString());a.equal(d,b.toString(2));--b});c.get(6);c.get(8);var d=[8,6,9,7,5],b=0;c.forEach(function(e,f,g){var h=d[b++];a.equal(g,c);a.equal(f,h.toString());a.equal(e,h.toString(2))});a.equal(b,d.length);a.end()});
test("keys() and values()",function(a){for(var c=new LRU(5),b=0;10>b;b++)c.set(b.toString(),b.toString(2));a.similar(c.keys(),["9","8","7","6","5"]);a.similar(c.values(),["1001","1000","111","110","101"]);c.get(6);c.get(8);a.similar(c.keys(),["8","6","9","7","5"]);a.similar(c.values(),["1000","110","1001","111","101"]);a.end()});
test("all entries are iterated over",function(a){for(var c=new LRU(5),b=0;10>b;b++)c.set(b.toString(),b.toString(2));b=0;c.forEach(function(a,c,f){0<b&&f.del(c);b+=1});a.equal(b,5);a.equal(c.keys().length,1);a.end()});test("all stale entries are removed",function(a){for(var c=new LRU({max:5,maxAge:-5,stale:!0}),b=0;10>b;b++)c.set(b.toString(),b.toString(2));b=0;c.forEach(function(){b+=1});a.equal(b,5);a.equal(c.keys().length,0);a.end()});
test("expires",function(a){for(var c=new LRU({max:10,maxAge:50}),b=0;10>b;b++)c.set(b.toString(),b.toString(2),b%2?25:void 0);var b=0,d=[8,6,4,2,0];setTimeout(function(){c.forEach(function(e,f,g){var h=d[b++];a.equal(g,c);a.equal(f,h.toString());a.equal(e,h.toString(2))});a.equal(b,d.length);setTimeout(function(){var b=0;c.forEach(function(a,c,d){b++});a.equal(0,b);a.end()},25)},26)});
