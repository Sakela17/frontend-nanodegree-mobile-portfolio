var duplexer=require("duplexer2"),Stream=require("stream"),slice=[].slice,opts={bubbleErrors:!1};module.exports=pipe;
function pipe(){if(1==arguments.length)return arguments[0];var c=slice.call(arguments),e;"function"==typeof c[c.length-1]&&(e=c.splice(-1)[0]);var a=c[0],b=c[c.length-1];var d=a.writable&&b.readable?duplexer(opts,a,b):a.writable?a:b.readable?b:new Stream;c.forEach(function(a,b){(b=c[b+1])&&a.pipe(b);if(a!=d)a.on("error",d.emit.bind(d,"error"))});if(e){var a=function(a){f||(f=!0,e(a))},f=!1;d.on("error",a);b.on("finish",a)}return d};
