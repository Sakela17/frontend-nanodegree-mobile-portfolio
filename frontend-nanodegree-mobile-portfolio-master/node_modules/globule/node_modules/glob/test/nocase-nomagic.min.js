var fs=require("graceful-fs"),test=require("tap").test,glob=require("../");
test("mock fs",function(a){function e(d){switch(d.toLowerCase()){case "/tmp":case "/tmp/":var a={isDirectory:function(){return!0}};break;case "/tmp/a":a={isDirectory:function(){return!1}}}return a}function b(d){switch(d.toLowerCase()){case "/tmp":case "/tmp/":var a=["a","A"];break;case "/":a=["tmp","tMp","tMP","TMP"]}return a}var c=fs.stat,f=fs.statSync,g=fs.readdir,h=fs.readdirSync;fs.stat=function(a,b){var d=e(a);d?process.nextTick(function(){b(null,d)}):c.call(fs,a,b)};fs.statSync=function(a){return e(a)||
f.call(fs,a)};fs.readdir=function(a,c){var d=b(a);d?process.nextTick(function(){c(null,d)}):g.call(fs,a,c)};fs.readdirSync=function(a){return b(a)||h.call(fs,a)};a.pass("mocked");a.end()});test("nocase, nomagic",function(a){var e=2,b="/TMP/A /TMP/a /tMP/A /tMP/a /tMp/A /tMp/a /tmp/A /tmp/a".split(" ");glob("/tmp/a",{nocase:!0},function(c,f){if(c)throw c;a.same(f.sort(),b);0===--e&&a.end()});glob("/tmp/A",{nocase:!0},function(c,f){if(c)throw c;a.same(f.sort(),b);0===--e&&a.end()})});
test("nocase, with some magic",function(a){a.plan(2);var e="/TMP/A /TMP/a /tMP/A /tMP/a /tMp/A /tMp/a /tmp/A /tmp/a".split(" ");glob("/tmp/*",{nocase:!0},function(b,c){if(b)throw b;a.same(c.sort(),e)});glob("/tmp/*",{nocase:!0},function(b,c){if(b)throw b;a.same(c.sort(),e)})});
